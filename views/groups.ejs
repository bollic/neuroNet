<%- include('layout/header') %>

<div class="max-w-6xl mx-auto p-8 space-y-6">
  <h2 class="text-3xl font-bold text-purple-700 text-center mb-8">
    ğŸŒ Tous les groupes actifs
  </h2>

  <% if (groupsPreview.length > 0) { %>
    <div class="grid md:grid-cols-3 gap-6">
      <% groupsPreview.forEach(group => { %>
      <div class="border rounded-xl p-4 bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50 hover:shadow-xl transition">

  <!-- ID + Numero Membri -->
  <div class="flex justify-between items-center mb-2">
    <span class="font-semibold text-lg text-purple-700 flex items-center gap-2">
      <i class="fas fa-users"></i> Groupe <%= group.groupId %>
    </span>
    <span class="text-xs px-2 py-1 rounded-full bg-purple-100 text-purple-700 font-medium">
      <%= group.totalMembers %> membres
    </span>
  </div>

  <!-- â­ï¸ Nome del gruppo -->
  <h3 class="text-md font-bold text-purple-800 mb-1">
    <%= group.name || "Nom de groupe non dÃ©fini" %>
  </h3>

  <!-- ğŸ“ Descrizione sintetica -->
  <p class="text-sm text-gray-700 italic mb-2">
    <%= group.description 
        ? (group.description.length > 80 
            ? group.description.substring(0, 80) + "..." 
            : group.description)
        : "Aucune description disponible." 
    %>
  </p>

  <!-- ğŸ·ï¸ Keywords -->
  <% if (group.keywords && group.keywords.length > 0) { %>
    <div class="flex flex-wrap gap-1 mb-3">
      <% group.keywords.forEach(kw => { %>
        <span class="text-xs bg-purple-200 text-purple-800 px-2 py-1 rounded-full">
          #<%= kw %>
        </span>
      <% }) %>
    </div>
  <% } %>

  <!-- ğŸ“Œ Points e ultimo punto -->
  <p class="text-sm text-gray-600 mb-1">
    <%= group.pointsCount %> points
  </p>

  <p class="text-xs text-gray-500 mb-3">
    ğŸ•“ Dernier point :
    <%= group.lastPoint ? group.lastPoint.name : 'â€“' %>
    <% if (group.lastPoint && group.lastPoint.createdAt) { %>
      (<%= new Date(group.lastPoint.createdAt).toLocaleDateString('fr-FR') %>)
    <% } %>
  </p>

  <!-- ğŸ‘¤ Mini-avatars -->
  <div class="flex -space-x-2 mb-4">
    <% group.membersPreview.forEach(member => { %>
      <div class="w-8 h-8 rounded-full flex items-center justify-center text-xs border-2 border-white 
        <%= member.role === 'office' ? 'bg-purple-600' : 'bg-gray-400' %> text-white shadow">
        <%= member.email[0].toUpperCase() %>
      </div>
    <% }) %>
  </div>

  <!-- Pulsanti -->
  <div class="flex gap-2">
    <a href="/groups/<%= group.groupId %>" class="btn btn-xs btn-outline btn-primary flex-1">ğŸ‘€ Voir</a>
    <a href="/signup?role=field&group=<%= group.groupId %>" class="btn btn-xs btn-primary flex-1">ğŸš€ Rejoindre</a>
  </div>

</div>

      <% }) %>
    </div>
  <% } else { %>
    <p class="text-gray-500 text-center">Aucun groupe actif pour le moment.</p>
  <% } %>
</div>

<%- include('layout/footerIndex') %>
